<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BOX SPORTS</title>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Video.js CSS -->
  <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
  <!-- Google Fonts: Inter -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #020617;
      transition: background-color 0.3s ease;
    }
    .custom-scrollbar::-webkit-scrollbar {
      width: 6px;
    }
    .custom-scrollbar::-webkit-scrollbar-track {
      background: #0f172a;
    }
    .custom-scrollbar::-webkit-scrollbar-thumb {
      background: #334155;
      border-radius: 10px;
    }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover {
      background: #475569;
    }
    .video-js {
      background-color: #000;
      width: 100%;
      height: 100%;
      transition: opacity 0.4s ease;
    }
    .vjs-control-bar {
      background-color: rgba(15, 23, 42, 0.7) !important;
      backdrop-filter: blur(4px);
    }
    .vjs-big-play-button {
      background-color: rgba(30, 144, 255, 0.5) !important;
      border-color: rgba(30, 144, 255, 0.8) !important;
      border-radius: 50%;
      width: 2em !important;
      height: 2em !important;
      line-height: 2em !important;
      margin-top: -1em !important;
      margin-left: -1em !important;
      transition: background-color 0.3s ease;
    }
    .vjs-big-play-button:hover {
      background-color: rgba(30, 144, 255, 0.75) !important;
      border-color: rgba(30, 144, 255, 1) !important;
    }
    .vjs-loading-spinner {
      border-top-color: #1e90ff !important;
    }
    .video-js .vjs-progress-control .vjs-play-progress {
      background-color: #1e90ff;
    }
    .vjs-channel-title {
      position: absolute;
      top: 20px;
      left: 20px;
      z-index: 10;
      color: white;
      background-color: rgba(0, 0, 0, 0.6);
      padding: 8px 16px;
      border-radius: 8px;
      font-size: 1.1rem;
      font-weight: 600;
      transition: opacity 0.5s ease-in-out;
      opacity: 0;
      pointer-events: none;
      user-select: none;
    }
    .vjs-channel-title.visible {
      opacity: 1;
    }
    #channel-list button {
      transition: background-color 0.25s, color 0.25s;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-weight: 500;
      outline-offset: 2px;
    }
    #channel-list button:hover:not(.active),
    #channel-list button:focus-visible:not(.active) {
      background-color: #1e293b;
      color: #94a3b8;
      outline: none;
    }
    #channel-list button.active {
      background-color: rgba(30, 144, 255, 0.2);
      color: #38bdf8;
    }
    #loading-overlay {
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 20;
      color: #1e90ff;
      font-weight: 700;
      font-size: 1.25rem;
      user-select: none;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    #loading-overlay.visible {
      opacity: 1;
      pointer-events: auto;
    }
    #theme-toggle {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #1e40af;
      color: white;
      padding: 10px 14px;
      border-radius: 9999px;
      font-weight: 600;
      cursor: pointer;
      user-select: none;
      box-shadow: 0 4px 12px rgb(30 64 175 / 0.5);
      transition: background-color 0.3s ease;
      z-index: 30;
    }
    #theme-toggle:hover {
      background-color: #2563eb;
    }
    .light-theme {
      background-color: #f8fafc;
      color: #1e293b;
    }
    .light-theme .vjs-channel-title {
      background-color: rgba(255, 255, 255, 0.7);
      color: #1e293b;
    }
    .light-theme #channel-list button.active {
      background-color: rgba(59, 130, 246, 0.3);
      color: #2563eb;
    }
  </style>
</head>
<body class="bg-slate-950 text-slate-300">

<div id="app" class="flex flex-col md:flex-row h-screen">

  <!-- Sidebar -->
  <aside class="w-full md:w-72 lg:w-80 bg-slate-900 border-r border-slate-700 flex flex-col">
    <div class="p-4 border-b border-slate-700">
      <h1 class="text-2xl font-extrabold tracking-widest text-sky-400 select-none">BOX SPORTS</h1>
    </div>
    <div class="flex-grow overflow-auto custom-scrollbar" tabindex="0" aria-label="Kanal listesi" id="channel-list" role="list">
      <!-- Kanallar JS ile gelecek -->
    </div>
  </aside>

  <!-- Player ve Video -->
  <main class="flex-grow relative bg-black flex flex-col">
    <div class="vjs-channel-title" id="channel-title" aria-live="polite" aria-atomic="true"></div>

    <div id="video-container" class="flex-grow relative">
      <div id="loading-overlay" role="status" aria-live="polite" aria-label="Yayın yükleniyor">Yükleniyor...</div>
      <video
        id="video-player"
        class="video-js vjs-big-play-centered"
        controls
        preload="auto"
        playsinline
        aria-label="Video Yayını"
        tabindex="0"
      ></video>
    </div>
  </main>

</div>

<button id="theme-toggle" aria-pressed="false" aria-label="Tema değiştir">Açık/Karanlık</button>

<!-- Video.js -->
<script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>

<script>
  (() => {
    const channels = [
      { id: "bein1", title: "Bein Sports 1", url: "https://bs.arectv33.sbs/static/bs1.m3u8" },
      { id: "bein2", title: "Bein Sports 2", url: "https://bs.arectv33.sbs/static/bs2.m3u8" },
      { id: "ss1", title: "S Sport 1", url: "https://bs.arectv33.sbs/static/ss11.m3u8" },
      { id: "smart1", title: "Smart Spor 1", url: "https://tv.arectv34.sbs/live/smart1.m3u8" },
      { id: "tivibu1", title: "Tivibu Spor 1", url: "https://tv.arectv34.sbs/live/t1.m3u8" },
      { id: "tabii0", title: "Tabii Spor 0", url: "https://beert7sqimrk0bfdupfgn6qew.medya.trt.com.tr/master.m3u8" },
      { id: "tabii1", title: "Tabii Spor 1", url: "https://iaqzu4szhtzeqd0edpsayinle.medya.trt.com.tr/master.m3u8" },
      { id: "atv", title: "ATV", url: "https://tv.arectv34.sbs/live/atv.m3u8" },
      // Telegram grubundan örnek ekleme (link doğruluğu garantisi yok, test etmen gerek)
      { id: "eurosport", title: "Eurosport", url: "https://eurosport-stream-url.m3u8" },
      { id: "sports1", title: "Sports1", url: "https://sports1-stream-url.m3u8" }
    ];

    const player = videojs('video-player', {
      fluid: true,
      playbackRates: [0.5, 1, 1.5, 2],
      controlBar: {
        volumePanel: { inline: false }
      },
      errorDisplay: true
    });

    const channelList = document.getElementById('channel-list');
    const channelTitle = document.getElementById('channel-title');
    const loadingOverlay = document.getElementById('loading-overlay');
    const themeToggle = document.getElementById('theme-toggle');
    const body = document.body;

    let currentChannelId = null;

    function renderChannelList() {
      channels.forEach(channel => {
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'w-full px-4 py-3 text-left rounded-md focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-offset-1';
        btn.setAttribute('role', 'listitem');
        btn.setAttribute('aria-pressed', 'false');
        btn.tabIndex = 0;
        btn.textContent = channel.title;
        btn.addEventListener('click', () => selectChannel(channel.id));
        channelList.appendChild(btn);
      });
    }

    function selectChannel(id) {
      if (id === currentChannelId) return;

      [...channelList.children].forEach(btn => {
        if (btn.textContent === getChannelTitle(id)) {
          btn.classList.add('active');
          btn.setAttribute('aria-pressed', 'true');
        } else {
          btn.classList.remove('active');
          btn.setAttribute('aria-pressed', 'false');
        }
      });

      currentChannelId = id;
      const channel = channels.find(c => c.id === id);

      if (!channel) return;

      showLoading(true);
      channelTitle.textContent = channel.title;
      channelTitle.classList.add('visible');

      player.src({ src: channel.url, type: 'application/x-mpegURL' });
      player.play().catch(() => {
        alert('Yayın oynatılamıyor.');
        showLoading(false);
      });
    }

    function showLoading(show) {
      if (show) {
        loadingOverlay.classList.add('visible');
      } else {
        loadingOverlay.classList.remove('visible');
      }
    }

    function hideChannelTitleDelayed() {
      setTimeout(() => {
        channelTitle.classList.remove('visible');
      }, 5000);
    }

    function getChannelTitle(id) {
      const channel = channels.find(c => c.id === id);
      return channel ? channel.title : '';
    }

    player.on('waiting', () => {
      showLoading(true);
    });
    player.on('playing', () => {
      showLoading(false);
      hideChannelTitleDelayed();
    });
    player.on('error', () => {
      showLoading(false);
      alert('Video oynatıcısında hata oluştu.');
    });

    function detectSystemTheme() {
      return window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches;
    }
    function applyTheme(light) {
      if (light) {
        body.classList.add('light-theme');
        themeToggle.textContent = 'Karanlık Tema';
        themeToggle.setAttribute('aria-pressed', 'true');
      } else {
        body.classList.remove('light-theme');
        themeToggle.textContent = 'Açık Tema';
        themeToggle.setAttribute('aria-pressed', 'false');
      }
      localStorage.setItem('boxsports-theme', light ? 'light' : 'dark');
    }

    themeToggle.addEventListener('click', () => {
      const isLight = body.classList.contains('light-theme');
      applyTheme(!isLight);
    });

    // Başlangıç teması
    const savedTheme = localStorage.getItem('boxsports-theme');
    if (savedTheme === 'light') {
      applyTheme(true);
    } else if (savedTheme === 'dark') {
      applyTheme(false);
    } else {
      applyTheme(detectSystemTheme());
    }

    renderChannelList();

    // İlk kanalı seç
    if (channels.length) {
      selectChannel(channels[0].id);
    }
  })();
</script>

</body>
</html>
